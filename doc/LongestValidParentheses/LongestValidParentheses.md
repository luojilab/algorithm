## ã€Longest Valid Parenthesesã€‘ 

Given a string containing just the characters '(' and ')', find the length of the longest valid (well-formed) parentheses substring. Each time you can either climb 1 or 2 steps. In how many distinct ways can you climb to the top? Note: Given n will be a positive integer. Example 1:
    Input: "(()"
    Output: 2
    Explanation: The longest valid parentheses substring is "()"
Example 2:
    Input: ")()())"
    Output: 4
    Explanation: The longest valid parentheses substring is "()()"

## 32.æœ€é•¿æœ‰æ•ˆæ‹¬å·ã€å›°éš¾ã€‘
ç»™å®šä¸€ä¸ªåªåŒ…å« '(' å’Œ ')' çš„å­—ç¬¦ä¸²ï¼Œæ‰¾å‡ºæœ€é•¿çš„åŒ…å«æœ‰æ•ˆæ‹¬å·çš„å­ä¸²çš„é•¿åº¦ã€‚
ç¤ºä¾‹Â 1:
è¾“å…¥: "(()"
è¾“å‡º: 
è§£é‡Š: æœ€é•¿æœ‰æ•ˆæ‹¬å·å­ä¸²ä¸º "()"

ç¤ºä¾‹ 2:
è¾“å…¥: ")()())"
è¾“å‡º: 4
è§£é‡Š: æœ€é•¿æœ‰æ•ˆæ‹¬å·å­ä¸²ä¸º "()()"

ç¤ºä¾‹ 3:
è¾“å…¥: "((())"
è¾“å‡º: 4
è§£é‡Š: æœ€é•¿æœ‰æ•ˆæ‹¬å·å­ä¸²ä¸º "(())"

## æ¦‚å¿µè§£é‡Š

è¿™é“é¢˜ï¼Œå†ä¸çœ‹Leecodeçš„æ—¶å€™ï¼Œéå¸¸å®¹æ˜“å¼„é”™é¢˜ç›®çš„å«ä¹‰ï¼Œé¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹é¢˜ç›®ä¸­çš„ä¸‰ä¸ªå…³é”®å› ç´ ã€‚

æœ‰æ•ˆæ‹¬å· -- 
1ã€(åœ¨å‰ï¼Œ)åœ¨å
2ã€å¦‚æœ(å’Œ)ä¹‹é—´æ˜¯(...)ä¸”(...)æ˜¯æœ‰æ•ˆæ‹¬å·åºåˆ—ï¼Œé‚£ä¹ˆ...ä¸€å®šç”±0åˆ°å¤šä¸ªä¸å®šé•¿åº¦çš„ã€æœ‰æ•ˆæ‹¬å·åºåˆ—ã€‘ç»„æˆ

é…å¯¹ -- æ ˆ

æœ€é•¿ -- åŠ¨æ€è§„åˆ’

## è§£æ³•1 - æš´åŠ›æ³•

åˆ—ä¸¾æ‰€æœ‰çš„å­—ç¬¦ä¸²ï¼Œç„¶ååˆ¤æ–­æ¯ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯ç¬¦åˆã€‚
ä¸ºäº†æ£€æŸ¥æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨æ ˆçš„æ–¹æ³•ã€‚

æ¯å½“æˆ‘ä»¬é‡åˆ°ä¸€ä¸ª ( ï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨æ ˆé¡¶ã€‚å¯¹äºé‡åˆ°çš„æ¯ä¸ª ) ï¼Œæˆ‘ä»¬ä»æ ˆä¸­å¼¹å‡ºä¸€ä¸ª ( ï¼Œå¦‚æœæ ˆé¡¶æ²¡æœ‰ (ï¼Œæˆ–è€…éå†å®Œæ•´ä¸ªå­å­—ç¬¦ä¸²åæ ˆä¸­ä»ç„¶æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆè¯¥å­å­—ç¬¦ä¸²æ˜¯æ— æ•ˆçš„ã€‚
è¿™ç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªå¶æ•°é•¿åº¦çš„å­å­—ç¬¦ä¸²éƒ½è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶ä¿å­˜ç›®å‰ä¸ºæ­¢æ‰¾åˆ°çš„æœ€é•¿çš„æœ‰æ•ˆå­å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚

å½“ç„¶è¿™é‡Œå¯ä»¥åšä¸ªä¼˜åŒ–å°±æ˜¯ï¼Œå› ä¸ºåˆæ³•å­—ç¬¦ä¸²ä¸€å®šæ˜¯å¶æ•°ä¸ªï¼Œæ‰€ä»¥å¯ä»¥åªåˆ—ä¸¾å¶æ•°é•¿åº¦çš„å­—ç¬¦ä¸²ã€‚åˆ—ä¸¾ä» 0 å¼€å§‹çš„ï¼Œé•¿åº¦æ˜¯ 2ã€4ã€6 â€¦â€¦çš„å­—ç¬¦ä¸²ï¼Œåˆ—ä¸¾ä¸‹æ ‡ä» 1 å¼€å§‹çš„ï¼Œé•¿åº¦æ˜¯ 2ã€4ã€6 â€¦â€¦çš„å­—ç¬¦ä¸²ï¼Œç„¶åå¾ªç¯ä¸‹å»ã€‚

ä¸¾ä¸ªğŸŒ°:
"((())"

(( --> æ— æ•ˆ
(( --> æ— æ•ˆ
() --> æœ‰æ•ˆï¼Œé•¿åº¦ä¸º 2
)) --> æ— æ•ˆ
((()--> æ— æ•ˆ
(())--> æœ‰æ•ˆï¼Œé•¿åº¦ä¸º 4
æœ€é•¿é•¿åº¦ä¸º 4

```objc

/// åˆ¤æ–­æ‹¬å·æ˜¯å¦æœ‰æ•ˆ
/// @param str ç›®æ ‡å­—ç¬¦ä¸²
+ (BOOL)isVailed:(NSString *)str {
    Stack *stack = [[Stack alloc] init];
    for (NSInteger i = 0; i < [str length]; i++) {
        NSString *temp = [str substringWithRange:NSMakeRange(i, 1)];
        if ([temp isEqualToString:@"("]) {
            [stack push:@"("];
        } else if (![stack isEmpty] && [[stack peek] isEqualToString:@"("]) {
            [stack popObj];
        } else {
            return NO;
        }
    }
    return [stack isEmpty];
}

/// æš´åŠ›è§£æ³•
/// @param str ç›®æ ‡å­—ç¬¦ä¸²
+ (NSInteger)violenceMethod:(NSString *)str {
    NSInteger maxLength = 0;
    for (NSInteger i = 0; i < [str length]; i++) {
        for (NSInteger j = i + 2; j <= [str length]; j+=2) {
            NSString *subString = [str substringWithRange:NSMakeRange(i, j - i)];
            if ([LongestValidParentheses isVailed:subString]) {
                maxLength = MAX(maxLength, j - i);
            }
            
        }
    }
    return maxLength;
}

```
æ—¶é—´å¤æ‚åº¦: åˆ—ä¸¾å­—ç¬¦ä¸²æ˜¯ Oï¼ˆnÂ²ï¼‰ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯åˆæ³•åºåˆ—æ˜¯ Oï¼ˆnï¼‰ï¼Œæ‰€ä»¥æ€»å…±æ˜¯ Oï¼ˆnÂ³ï¼‰ã€‚

ç©ºé—´å¤æ‚åº¦ï¼šOï¼ˆnï¼‰ï¼Œæ¯æ¬¡åˆ¤æ–­çš„æ—¶å€™ï¼Œæ ˆçš„å¤§å°ã€‚

è¿™ä¸ªç®—æ³•ï¼ŒleetCode ä¼šæŠ¥æ—¶é—´è¶…æ—¶ã€‚
é‚£æœ‰æ²¡æœ‰å…¶ä»–çš„è§£æ³•å‘¢ï¼Ÿ


## è§£æ³•2 - åŠ¨æ€è§„åˆ’

åŠ¨æ€è§„åˆ’é¢˜ç›®åˆ†æçš„4ä¸ªæ­¥éª¤ï¼š

1ã€ç¡®å®šçŠ¶æ€
    ç ”ç©¶æœ€ä¼˜ç­–ç•¥çš„æœ€åä¸€æ­¥
    åŒ–ä¸ºå­é—®é¢˜
2ã€è½¬ç§»æ–¹ç¨‹
    æ ¹æ®å­é—®é¢˜å®šä¹‰å¾—åˆ°
3ã€åˆå§‹æ¡ä»¶å’Œè¾¹ç•Œæƒ…å†µ
4ã€è®¡ç®—é¡ºåº


### ç¡®å®šçŠ¶æ€

å¯¹äºæœ€ä¼˜çš„ç­–ç•¥ï¼Œä¸€å®šæœ‰æœ€åä¸€ä¸ªå…ƒç´  str[i]
æ‰€ä»¥ï¼Œæˆ‘ä»¬å…ˆçœ‹ç¬¬ i ä¸ªä½ç½®ï¼Œè¿™ä¸ªä½ç½®çš„å…ƒç´  str[i]å¯èƒ½æœ‰å¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š
ç¬¬ä¸€ç§æƒ…å†µï¼š**str[i] == '('**
è¿™æ—¶ï¼Œstr[i] æ— æ³•å’Œå…¶ä¹‹å‰çš„å…ƒç´ ç»„æˆæœ‰æ•ˆçš„æ‹¬å·å¯¹ï¼Œæ‰€ä»¥ï¼Œdp[i] = 0

ç¬¬äºŒç§æƒ…å†µï¼š**str[i] == ')'**
è¿™æ—¶ï¼Œéœ€è¦çœ‹å…¶å‰é¢å¯¹å…ƒç´ æ¥åˆ¤æ–­æ˜¯å¦æœ‰æœ‰æ•ˆæ‹¬å·å¯¹ã€‚åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š

æƒ…å†µ1:**str[i - 1] == '('**
å³ str[i] å’Œ str[i - 1] ç»„æˆä¸€å¯¹æœ‰æ•ˆæ‹¬å·ï¼Œæœ‰æ•ˆæ‹¬å·é•¿åº¦æ–°å¢é•¿åº¦**2**
iä½ç½®å¯¹æœ€é•¿æœ‰æ•ˆæ‹¬å·é•¿åº¦ä¸º å…¶ä¹‹å‰2ä¸ªä½ç½®çš„æœ€é•¿æ‹¬å·é•¿åº¦ï¼ŒåŠ ä¸Šå½“å‰ä½ç½®æ–°å¢çš„2ï¼Œæˆ‘ä»¬æ— éœ€çŸ¥é“i-2ä½ç½®å¯¹å­—ç¬¦æ˜¯å¦å¯ä»¥ç»„æˆæœ‰æ•ˆæ‹¬å·å¯¹ã€‚
é‚£ä¹ˆå¾—åˆ°å¦‚ä¸‹æ–¹ç¨‹
**dp[i] = dp[i - 2] + 2**
å¦‚ä¸‹å›¾ï¼š

![](../../res/LongestValidParentheses/1.png)

æƒ…å†µ2:**str[i - 1] == ')'**
è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœå‰é¢æœ‰å’Œstr[i]ç»„æˆæœ‰æ•ˆæ‹¬å·å¯¹çš„å­—ç¬¦ï¼Œå³å½¢å¦‚( (....) )ï¼Œè¿™æ ·çš„è¯ï¼Œå°±è¦æ±‚str[i - 1]ä½ç½®å¿…ç„¶æ˜¯æœ‰æ•ˆçš„æ‹¬å·å¯¹ï¼Œå¦åˆ™str[i]æ— æ³•å’Œå‰é¢å¯¹å­—ç¬¦ç»„æˆæœ‰æ•ˆæ‹¬å·å¯¹ã€‚

è¿™æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°å’Œstr[i]é…å¯¹å¯¹ä½ç½®ï¼Œå¹¶åˆ¤æ–­å…¶æ˜¯å¦æ˜¯ ( å³å¯ã€‚å’Œå…¶é…å¯¹çš„ä½ç½®ä¸ºï¼ši - dp[i - 1] âˆ’1ã€‚

å¦‚æœï¼š**str[i - dp[i - 1] âˆ’1] == '('**

æœ‰æ•ˆæ‹¬å·é•¿åº¦æ–°å¢é•¿åº¦2ï¼Œiä½ç½®å¯¹æœ€é•¿æœ‰æ•ˆæ‹¬å·é•¿åº¦ä¸º i-1ä½ç½®çš„æœ€é•¿æ‹¬å·é•¿åº¦åŠ ä¸Šå½“å‰ä½ç½®æ–°å¢çš„2ï¼Œé‚£ä¹ˆæœ‰ï¼š
**dp[i] = dp[iâˆ’1] + 2**

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œi - dp[i - 1] - 1 å’Œ i ç»„æˆäº†æœ‰æ•ˆæ‹¬å·å¯¹ï¼Œè¿™å°†æ˜¯ä¸€æ®µç‹¬ç«‹çš„æœ‰æ•ˆæ‹¬å·åºåˆ—ï¼Œå¦‚æœä¹‹å‰çš„å­åºåˆ—æ˜¯å½¢å¦‚ (...)(...) è¿™ç§åºåˆ—ï¼Œé‚£ä¹ˆå½“å‰ä½ç½®çš„æœ€é•¿æœ‰æ•ˆæ‹¬å·é•¿åº¦è¿˜éœ€è¦åŠ ä¸Šè¿™ä¸€æ®µã€‚æ‰€ä»¥ï¼š

**dp[i]= dp[iâˆ’1] + dp[i âˆ’ dp[iâˆ’1] âˆ’ 2]+2**

![](../../res/LongestValidParentheses/2.png)

### å­é—®é¢˜

æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬å¾—åˆ°äº†å¦‚ä¸‹ä¸¤ä¸ªè®¡ç®—å…¬å¼ï¼š

dp[i] = dp[iâˆ’2] + 2

dp[i] = dp[iâˆ’1] + dp[iâˆ’dp[iâˆ’1]âˆ’2]+2

é‚£ä¹ˆï¼Œæ±‚dp[i]å°±å˜æˆäº†æ±‚dp[i - 1]ã€ dp[i - 2]dã€dp[i - dp[i - 1] - 2]çš„å­é—®é¢˜ã€‚

è¿™æ ·çŠ¶æ€ä¹Ÿæ˜ç¡®äº†ï¼š

è®¾dp æ•°ç»„ï¼Œå…¶ä¸­ç¬¬ i ä¸ªå…ƒç´ è¡¨ç¤ºä»¥ä¸‹æ ‡ä¸º i çš„å­—ç¬¦ç»“å°¾çš„æœ€é•¿æœ‰æ•ˆå­å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚

### çŠ¶æ€è½¬ç§»æ–¹ç¨‹

**ä»¥ ( ç»“å°¾çš„å­å­—ç¬¦ä¸²ä¸è€ƒè™‘ï¼Œå› ä¸ºä¸å¯èƒ½æ„æˆåˆæ³•æ‹¬å·**

å¦‚æœå½“å‰ä½ç½®çš„æ‹¬å·æ˜¯å³æ‹¬å·ï¼š str[i] == ')'ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æ¨æ–­ï¼Ÿ
1ã€å¦‚æœå½“å‰ä½ç½®çš„å‰é¢ä¸€ä½æ˜¯å·¦æ‹¬å·ï¼šstr[i - 1] == '('ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å½¢å¦‚ â€œâ€¦â€¦()â€ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å‡ºï¼š
dp[i] = dp[i âˆ’ 2] + 2ã€‚
å› ä¸ºç»“æŸéƒ¨åˆ†çš„ "()" æ˜¯ä¸€ä¸ªæœ‰æ•ˆå­å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å°†ä¹‹å‰æœ‰æ•ˆå­å­—ç¬¦ä¸²çš„é•¿åº¦å¢åŠ äº† 2.

2ã€å¦‚æœå½“å‰ä½ç½®çš„å‰é¢ä¸€ä½æ˜¯å³æ‹¬å·ï¼šs[i - 1] == ')'ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å½¢å¦‚ â€œ.......))â€ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å‡ºï¼š
    ç»§ç»­å‘å‰æ‰«æï¼Œå¦‚æœå‘ç°å·¦æ‹¬å·ï¼šif s[i - dp[i - 1] - 1] == '('ï¼Œ
    dp[i] = dp[i âˆ’ 1] + dp[i âˆ’ dp[i âˆ’ 1] âˆ’ 2] + 2ã€‚
å› ä¸ºå¦‚æœå€’æ•°ç¬¬äºŒä¸ª )æ˜¯ä¸€ä¸ªæœ‰æ•ˆå­å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼ˆè®°ä¸ºsubsï¼‰ï¼Œ
æˆ‘ä»¬æ­¤æ—¶éœ€è¦åˆ¤æ–­ subs å‰é¢ä¸€ä¸ªç¬¦å·æ˜¯ä¸æ˜¯ ( ï¼Œ
å¦‚æœæ°å¥½æ˜¯(ï¼Œæˆ‘ä»¬å°±ç”¨ subs çš„é•¿åº¦(dp[i - 1)åŠ ä¸Š 2 å»æ›´æ–° dp[i]ã€‚
é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬ä¹Ÿä¼šæŠŠå­å­—ç¬¦ä¸² subs å‰é¢çš„æœ‰æ•ˆå­—ç¬¦ä¸²çš„é•¿åº¦åŠ ä¸Šï¼Œä¹Ÿå°±æ˜¯ dp[i âˆ’ dp[i âˆ’ 1] âˆ’ 2].

### è¾¹ç•Œæƒ…å†µ
i - 2 æœ‰å¯èƒ½å°äºé›¶è¶Šç•Œäº†ï¼Œè¿™ç§æƒ…å†µä¸‹å°±æ˜¯åªæœ‰ () ï¼Œå‰é¢è®°ä¸º 0 å°±å¥½äº†.
i - dp[i - 1] - 1 å’Œ i - dp[i - 1] - 2 éƒ½å¯èƒ½è¶Šç•Œï¼Œè¶Šç•Œäº†å½“æˆ 0 æ¥è®¡ç®—å°±å¯ä»¥äº†.

### ç¡®å®šçŠ¶æ€

æ— è®ºç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä»€ä¹ˆï¼Œéƒ½æœ‰ï¼šdp[0] = 0
ç„¶åä¾æ¬¡è®¡ç®—ï¼šdp[1], dp[2], ..., dp[n - 1]
ç»“æœæ˜¯ï¼š max(dp[i])
 
```objc

/// åŠ¨æ€è§„åˆ’
/// @param str å­—ç¬¦ä¸²
+ (NSInteger)dynamicProgrammingMethod:(NSString *)str {
    NSInteger maxLength = 0;
    NSMutableArray *dpArray = [[NSMutableArray alloc] initWithCapacity:str.length];
    //dpæ•°ç»„å…ˆå¡«å……è¡¥0
    for (NSInteger i = 0; i < [str length]; i++) {
        [dpArray addObject:@(0)];
    }
    //ä¸€æ¬¡éå†
    for (NSInteger i = 1; i < [str length]; i++) {
        NSString *temp = [str substringWithRange:NSMakeRange(i, 1)];
        //åˆ¤æ–­å³æ‹¬å·
        if ([temp isEqualToString:@")"]) {
            NSString *lastTemp = [str substringWithRange:NSMakeRange(i - 1, 1)];
            //å³æ‹¬å·å‰è¾¹æ˜¯å·¦æ‹¬å·
            if ([lastTemp isEqualToString:@"("]) {
                NSInteger length = i >= 2 ? [dpArray[i - 2] integerValue] : 0;
                length = length + 2;
                dpArray[i] = [NSNumber numberWithInteger:length];
                //å³æ‹¬å·å‰è¾¹æ˜¯å³æ‹¬å·ï¼Œå¹¶ä¸”é™¤å»å‰è¾¹çš„åˆæ³•åºåˆ—çš„å‰è¾¹æ˜¯å·¦æ‹¬å·
            } else if (i - [dpArray[i - 1] integerValue] - 1 >= 0) {
                NSString *lastlastTemp = [str substringWithRange:NSMakeRange(i - [dpArray[i - 1] integerValue] - 1, 1)];
                if ([lastlastTemp isEqualToString:@"("]) {
                    NSInteger length = (i - [dpArray[i - 1] integerValue] - 2) >= 0 ? [dpArray[i - [dpArray[i - 1] integerValue] - 2] integerValue] : 0;
                    length = length + [dpArray[i - 1] integerValue] + 2;
                    dpArray[i] = [NSNumber numberWithInteger:length];
                }
            }
        }
        maxLength = MAX(maxLength, [dpArray[i] integerValue]);
    }
    return maxLength;
}

```

æ—¶é—´å¤æ‚åº¦ï¼š O(n) ã€‚éå†æ•´ä¸ªå­—ç¬¦ä¸²ä¸€æ¬¡ï¼Œå°±å¯ä»¥å°† dp æ•°ç»„æ±‚å‡ºæ¥ã€‚
ç©ºé—´å¤æ‚åº¦ï¼š O(n) ã€‚éœ€è¦ä¸€ä¸ªå¤§å°ä¸º length çš„ dp æ•°ç»„ã€‚


## è§£æ³•3 - æ ˆè§£æ³•

ä»å·¦åˆ°å³æ‰«æå­—ç¬¦ä¸²ï¼Œæ ˆé¡¶ä¿å­˜å½“å‰æ‰«æçš„æ—¶å€™ï¼Œåˆæ³•åºåˆ—å‰çš„ä¸€ä¸ªä½ç½®ä½ç½®ä¸‹æ ‡æ˜¯å¤šå°‘ã€‚

å…·ä½“è§£é‡Šä¸€ä¸‹å§ï¼š

æˆ‘ä»¬æ‰«æåˆ°å·¦æ‹¬å·ï¼Œå°±å°†å½“å‰**ä½ç½®**å…¥æ ˆã€‚

æ‰«æåˆ°å³æ‹¬å·ï¼Œå°±å°†æ ˆé¡¶å‡ºæ ˆï¼ˆä»£è¡¨æ ˆé¡¶çš„å·¦æ‹¬å·åŒ¹é…åˆ°äº†å³æ‹¬å·ï¼‰ï¼Œç„¶ååˆ†ä¸¤ç§æƒ…å†µã€‚

1ã€æ ˆä¸ç©ºï¼Œé‚£ä¹ˆå°±ç”¨å½“å‰çš„ä½ç½®å‡å»æ ˆé¡¶çš„å­˜çš„ä½ç½®ï¼Œç„¶åå°±å¾—åˆ°å½“å‰åˆæ³•åºåˆ—çš„é•¿åº¦ï¼Œç„¶åæ›´æ–°ä¸€ä¸‹æœ€é•¿é•¿åº¦ã€‚
2ã€æ ˆæ˜¯ç©ºçš„ï¼Œè¯´æ˜ä¹‹å‰æ²¡æœ‰ä¸ä¹‹åŒ¹é…çš„å·¦æ‹¬å·ï¼Œé‚£ä¹ˆå°±å°†å½“å‰çš„ä½ç½®å…¥æ ˆã€‚

æˆ‘ä»¬æ¥å…·ä½“çœ‹ä¸‹é¢çš„å›¾ç¤ºï¼š

![](../../res/LongestValidParentheses/LongestValidParentheses.gif)

```objc

/// æ ˆè§£æ³•
/// @param str ç›®æ ‡å­—ç¬¦ä¸²
+ (NSInteger)stackMethod:(NSString *)str{
    NSInteger maxLength = 0;
    Stack *stack = [[Stack alloc] init];
    [stack push:@(-1)];
    for (NSInteger i = 0; i < [str length]; i++) {
        NSString *temp = [str substringWithRange:NSMakeRange(i, 1)];
        if ([temp isEqualToString:@"("]) {
            [stack push:@(i)];
        } else {
            [stack popObj];
            if ([stack isEmpty]) {
                [stack push:@(i)];
            } else {
                maxLength = MAX(maxLength, i - [[stack peek] integerValue]);
            }
        }
    }
    return maxLength;
}

```


æ—¶é—´å¤æ‚åº¦ï¼š O(n) ã€‚næ˜¯ç»™å®šå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚
ç©ºé—´å¤æ‚åº¦ï¼š O(n) ã€‚æ ˆçš„å¤§å°ï¼Œæœ€å¤§è¾¾åˆ° n ã€‚

## è§£æ³•4 - å·¦å³æ‰«æè®¡æ•°æ³•

ä»å·¦åˆ°å³æ‰«æï¼Œç”¨ä¸¤ä¸ªå˜é‡ left å’Œ right ä¿å­˜çš„å½“å‰çš„å·¦æ‹¬å·å’Œå³æ‹¬å·çš„ä¸ªæ•°ï¼Œéƒ½åˆå§‹åŒ–ä¸º 0 ã€‚

*å¦‚æœå·¦æ‹¬å·ä¸ªæ•°ç­‰äºå³æ‹¬å·ä¸ªæ•°äº†ï¼Œé‚£ä¹ˆå°±æ›´æ–°åˆæ³•åºåˆ—çš„æœ€é•¿é•¿åº¦ã€‚*
*å¦‚æœå·¦æ‹¬å·ä¸ªæ•°å¤§äºå³æ‹¬å·ä¸ªæ•°äº†ï¼Œé‚£ä¹ˆå°±æ¥ç€å‘å³è¾¹æ‰«æã€‚*
*å¦‚æœå·¦æ‹¬å·æ•°ç›®å°äºå³æ‹¬å·ä¸ªæ•°äº†ï¼Œé‚£ä¹ˆåè¾¹æ— è®ºæ˜¯ä»€ä¹ˆï¼Œæ­¤æ—¶éƒ½ä¸å¯èƒ½æ˜¯åˆæ³•åºåˆ—äº†ï¼Œæ­¤æ—¶ left å’Œ right å½’ 0ï¼Œç„¶åæ¥ç€æ‰«æã€‚*

ä»å·¦åˆ°å³æ‰«æå®Œæ¯•åï¼ŒåŒæ ·çš„æ–¹æ³•ä»å³åˆ°å·¦å†æ¥ä¸€æ¬¡
å› ä¸ºç±»ä¼¼è¿™æ ·çš„æƒ…å†µ ( ( ( ) ) ï¼Œå¦‚æœä»å·¦åˆ°å³æ‰«æåˆ°æœ€åï¼Œleft = 3ï¼Œright = 2ï¼Œ
æœŸé—´ä¸ä¼šå‡ºç° left == rightã€‚ä½†æ˜¯å¦‚æœä»å³å‘å·¦æ‰«æï¼Œæ‰«æåˆ°å€’æ•°ç¬¬äºŒä¸ªä½ç½®çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç° left = 2ï¼Œright = 2 ï¼Œå°±ä¼šå¾—åˆ°ä¸€ç§åˆæ³•åºåˆ—ã€‚

**æ„Ÿå…´è¶£å¤§å®¶å¯ä»¥è®¨è®ºä¸‹è§£æ³•çš„æ€è·¯ä»ä½•è€Œæ¥ï¼ˆæœ‰æ•ˆæ‹¬å·çš„æ¦‚å¿µï¼‰**

```objc
/// å·¦å³æ‰«æè§£æ³•
/// @param str ç›®æ ‡å­—ç¬¦ä¸²
+ (NSInteger)leftAndRightScanningMethod:(NSString *)str{
    NSInteger left = 0;
    NSInteger right = 0;
    NSInteger maxLength = 0;
    //ä»å·¦åˆ°å³æ‰«æ
    for (NSInteger i = 0; i < [str length]; i++) {
        NSString *temp = [str substringWithRange:NSMakeRange(i, 1)];
        if ([temp isEqualToString:@"("]) {
            left++;
        } else {
            right++;
        }
        if (left == right) {
            maxLength = MAX(maxLength , 2 * left);
        } else if (right > left){
            left = 0;
            right = 0;
        }
    }
    left = 0;
    right = 0;
    //ä»å³åˆ°å·¦æ‰«æ
    for (NSInteger i = [str length] - 1; i >= 0; i--) {
        NSString *temp = [str substringWithRange:NSMakeRange(i, 1)];
        if ([temp isEqualToString:@"("]) {
            left++;
        } else {
            right++;
        }
        if (left == right) {
            maxLength = MAX(maxLength , 2 * left);
        } else if (left > right){
            left = 0;
            right = 0;
        }
    }
    return maxLength;
}
```

æ—¶é—´å¤æ‚åº¦ï¼š O(n) ã€‚éå†ä¸¤éå­—ç¬¦ä¸²ã€‚
ç©ºé—´å¤æ‚åº¦ï¼š O(1) ã€‚ä»…æœ‰ä¸¤ä¸ªé¢å¤–çš„Integerå˜é‡ left å’Œ right ã€‚
